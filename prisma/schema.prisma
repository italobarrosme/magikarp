generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id       String          @id @default(uuid())
  name     String
  phone    String          @unique
  role     String          @default("employee")
  messages SentMessage[]
  events   PhishingEvent[]
}

model Campaign {
  id             String            @id @default(uuid())
  title          String
  createdAt      DateTime          @default(now())
  messages       PhishingMessage[]
  sentMessages   SentMessage[]
  phishingEvents PhishingEvent[]
}

model PhishingMessage {
  id         String   @id @default(uuid())
  content    String
  campaignId String
  campaign   Campaign @relation(fields: [campaignId], references: [id])
}

model SentMessage {
  id         String   @id @default(uuid())
  campaignId String
  userId     String
  whatsappId String?
  sentAt     DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id])
  campaign   Campaign @relation(fields: [campaignId], references: [id])
}

model PhishingEvent {
  id         String   @id @default(uuid())
  type       String // click | report
  createdAt  DateTime @default(now())
  userId     String
  campaignId String
  metadata   Json?
  user       User     @relation(fields: [userId], references: [id])
  campaign   Campaign @relation(fields: [campaignId], references: [id])
}
